# AI Development Rules for Moneta App

This document outlines the technical stack and development conventions for the Moneta application. Adhering to these rules ensures consistency, maintainability, and stability.

## Tech Stack Overview

The application is built with a focus on performance and simplicity, using a curated set of libraries and vanilla JavaScript.

*   **Core Language**: Vanilla JavaScript (ES6 Modules). All application logic is written using standard JS without a front-end framework.
*   **Desktop Framework**: [Electron](https://www.electronjs.org/) is used to package the web application for cross-platform desktop use (Windows, macOS, Linux).
*   **Build System**: [Vite](https://vitejs.dev/) serves as the build tool for a fast development server and optimized production builds.
*   **Styling**: [Tailwind CSS](https://tailwindcss.com/) (via CDN) is the primary tool for styling. It is supplemented by custom, reusable component styles in `assets/css/style.css`.
*   **Charting & Visualization**: [Chart.js](https://www.chartjs.org/) is the exclusive library for rendering all charts and graphs within the application.
*   **Data Security**: [CryptoJS](https://cryptojs.gitbook.io/docs/) is used for AES encryption of all user data before it's saved to `localStorage`.
*   **Data Export**: [SheetJS (xlsx.js)](https://sheetjs.com/) is used for generating and exporting data to CSV format in the reports module.
*   **OCR (Optical Character Recognition)**: [Tesseract.js](https://tesseract.projectnaptha.com/) is integrated to extract text from user-uploaded images and PDFs for the statement import feature.
*   **Application Structure**: The app follows a modular, single-page application (SPA) pattern, managed by the main `app.js` controller.

## Library and Pattern Usage Rules

To maintain a clean and predictable codebase, follow these specific rules for common tasks.

### 1. DOM Manipulation
- **DO NOT** add any DOM manipulation libraries like jQuery.
- **ALWAYS** use native Web APIs for all DOM interactions (`document.getElementById`, `document.querySelector`, `element.addEventListener`, `element.innerHTML`, etc.).

### 2. UI Components (Modals, Prompts)
- **ALWAYS** use the custom modal utility found in `js/utils/modal.js`.
- Use `openModal()` for custom content, `openAlert()` for simple messages, `openConfirmation()` for yes/no dialogs, and `openPrompt()` for user input.
- **DO NOT** implement new modal logic or introduce a UI component library.

### 3. Data Formatting
- **ALWAYS** use the centralized formatting functions in `js/utils/formatters.js`.
- Use `formatCurrency()` for displaying monetary values to the user.
- Use `formatDate()` for displaying dates.
- Use `parseCurrency()` when converting user input back to a number.

### 4. State Management & Data Flow
- The global application state is managed within the `MonetaApp` object in `js/app.js`.
- **ALWAYS** access user data through `appInstance.state.data`.
- **ALWAYS** persist changes by calling `appInstance.saveData()`. This ensures data is encrypted before being written to `localStorage`.
- **DO NOT** store sensitive data outside of the main state object or write directly to `localStorage`.

### 5. Navigation
- Page and view changes within the app are handled by `appInstance.navigateTo('viewName')`.
- **ALWAYS** use this function to switch between modules (e.g., from 'dashboard' to 'despesas').
- **DO NOT** implement any other form of routing.

### 6. Icons
- Icons are implemented as inline SVG strings stored in constants (e.g., the `ICONS` object in `js/modules/sidebar.js`).
- **ALWAYS** follow this pattern for new icons to keep them self-contained and performant. If many new icons are needed, consider centralizing them in a `js/utils/icons.js` file.

### 7. Styling
- **Prioritize** using Tailwind CSS utility classes directly in the HTML generated by JavaScript modules.
- For complex, reusable component styles or animations that are difficult to manage with utilities, add classes to `assets/css/style.css`.
- **DO NOT** use inline `style` attributes unless absolutely necessary for dynamic values (e.g., setting a chart's width percentage).